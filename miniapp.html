<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TalantaCoin Mini App</title>
<style>
body {
    margin:0;
    font-family: Arial,sans-serif;
    background: url('https://s6.uupload.ir/files/1000056953_myyj.png') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
    text-align: center;
}
header { margin-top: 20px; }
header img { width: 15%; } /* لوگو سه برابر شد */
header h1 { margin: 10px 0 5px 0; font-size: 24px; color: #ff0000; }
header p { font-size: 16px; }

.auth-section, .social-buttons, .stats, .referral { margin: 20px 0; }

button {
    padding: 10px 20px;
    margin: 5px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    border-radius: 5px;
    transition: all 0.3s ease;
}
button:hover { transform: scale(1.1); box-shadow: 0 0 10px #ff0; }

.social-buttons img {
    width: 50px;
    margin: 10px;
    cursor: pointer;
    vertical-align: middle;
    transition: all 0.3s ease;
}
.social-buttons img:hover { transform: scale(1.2); filter: brightness(1.5); }

.stats span { font-weight: bold; color: #ff0; }
input {
    padding: 8px;
    margin: 5px;
    border-radius: 5px;
    border: none;
    width: 200px;
}
.hidden { display:none; }
</style>
</head>
<body>

<header>
    <img src="https://s6.uupload.ir/files/1761571561974_mpn7.png" alt="TalantaCoin Logo">
    <h1>TalantaCoin</h1>
    <p>Complete missions to earn 1 TALA.<br>Earn 0.5 TALA per referral and per social media video view.</p>
</header>

<div class="auth-section">
    <div id="registerDiv">
        <h3>Register</h3>
        <input type="email" id="regEmail" placeholder="Gmail"><br>
        <input type="password" id="regPass" placeholder="Password"><br>
        <input type="password" id="regPassConfirm" placeholder="Confirm Password"><br>
        <button onclick="registerUser()">Register</button>
    </div>

    <div id="loginDiv" class="hidden">
        <h3>Login</h3>
        <input type="email" id="loginEmail" placeholder="Gmail"><br>
        <input type="password" id="loginPass" placeholder="Password"><br>
        <button onclick="loginUser()">Login</button>
    </div>

    <div id="gmailLoginDiv" class="hidden">
        <h3>Login with Gmail</h3>
        <input type="email" id="gmailOnlyEmail" placeholder="Gmail"><br>
        <button onclick="gmailLogin()">Login</button>
    </div>
</div>

<div class="stats hidden" id="userStats">
    <p>Total TALA: <span id="totalTALA">0</span></p>
</div>

<div class="social-buttons hidden" id="socialButtons">
    <div>
        <img src="https://s6.uupload.ir/files/1761565805692_xev1.png" alt="YouTube" onclick="completeMission('youtube',1)">
        <span id="ytReward">1 TALA</span>
    </div>
    <div>
        <img src="https://s6.uupload.ir/files/1761565929838_lcd7.png" alt="Instagram" onclick="completeMission('instagram',0.5)">
        <span id="instaReward">0.5 TALA</span>
    </div>
    <div>
        <img src="https://s6.uupload.ir/files/1761565975760_37uu.png" alt="TikTok" onclick="completeMission('tiktok',0.5)">
        <span id="ttReward">0.5 TALA</span>
    </div>
    <div>
        <img src="https://s6.uupload.ir/files/1761566122776_0xlc.png" alt="Telegram" onclick="completeMission('telegram',0.5)">
        <span id="tgReward">0.5 TALA</span>
    </div>
    <div>
        <img src="https://s6.uupload.ir/files/1761566178319_vj8h.png" alt="X" onclick="completeMission('x',0.5)">
        <span id="xReward">0.5 TALA</span>
    </div>
</div>

<div class="referral hidden" id="referralDiv">
    <p>Your referral link: <span id="refLink"></span></p>
</div>

<script>
let currentUser = localStorage.getItem('currentUser') || null;
let users = JSON.parse(localStorage.getItem('users') || '{}');
let userTALA = JSON.parse(localStorage.getItem('userTALA') || '{}');
let refLinks = JSON.parse(localStorage.getItem('refLinks') || {});
let missionsDone = JSON.parse(localStorage.getItem('missionsDone') || {});

function saveData(){
    localStorage.setItem('users', JSON.stringify(users));
    localStorage.setItem('userTALA', JSON.stringify(userTALA));
    localStorage.setItem('refLinks', JSON.stringify(refLinks));
    localStorage.setItem('missionsDone', JSON.stringify(missionsDone));
    if(currentUser) localStorage.setItem('currentUser', currentUser);
}

function registerUser() {
    const email = document.getElementById('regEmail').value.trim();
    const pass = document.getElementById('regPass').value.trim();
    const confirm = document.getElementById('regPassConfirm').value.trim();
    if(!email || !pass || !confirm){
        alert('Please fill all fields.');
        return;
    }
    if(pass !== confirm){
        alert('Passwords do not match.');
        return;
    }
    if(users[email]){
        alert('Email already registered.');
        return;
    }
    users[email] = pass;
    userTALA[email] = 0;
    missionsDone[email] = {};
    refLinks[email] = 'https://yourapp.com/?ref='+btoa(email);
    saveData();
    alert('Registration successful! Your referral link: '+refLinks[email]);
    document.getElementById('registerDiv').classList.add('hidden');
    document.getElementById('loginDiv').classList.remove('hidden');
}

function loginUser() {
    const email = document.getElementById('loginEmail').value.trim();
    const pass = document.getElementById('loginPass').value.trim();
    if(users[email] && users[email] === pass){
        currentUser = email;
        showApp();
    } else {
        alert('Invalid login.');
    }
}

function gmailLogin() {
    const email = document.getElementById('gmailOnlyEmail').value.trim();
    if(!email || !users[email]){
        alert('Email not registered.');
        return;
    }
    currentUser = email;
    showApp();
}

function showApp(){
    document.getElementById('registerDiv').classList.add('hidden');
    document.getElementById('loginDiv').classList.add('hidden');
    document.getElementById('gmailLoginDiv').classList.add('hidden');
    document.getElementById('socialButtons').classList.remove('hidden');
    document.getElementById('userStats').classList.remove('hidden');
    document.getElementById('referralDiv').classList.remove('hidden');
    document.getElementById('totalTALA').textContent = userTALA[currentUser];
    document.getElementById('refLink').textContent = refLinks[currentUser];
    saveData();
}

function completeMission(platform, amount){
    if(!currentUser){
        alert('Please login first.');
        return;
    }
    if(!missionsDone[currentUser][platform]){
        userTALA[currentUser] += amount;
        missionsDone[currentUser][platform] = true;
        document.getElementById('totalTALA').textContent = userTALA[currentUser];
        document.getElementById(platform+'Reward').textContent = '0 TALA';
        alert('You earned '+amount+' TALA for completing '+platform+' mission!');
        saveData();
    } else {
        alert('Mission already completed!');
    }
}

// auto-login if already registered
if(currentUser){
    showApp();
} else {
    document.getElementById('registerDiv').classList.remove('hidden');
    document.getElementById('loginDiv').classList.remove('hidden');
    document.getElementById('gmailLoginDiv').classList.remove('hidden');
}
</script>

</body>
</html>
